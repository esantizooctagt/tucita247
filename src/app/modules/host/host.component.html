<div class="container-fluid host-container">
    <div class="row pl-2 pr-2">
        <ng-container *ngIf="showDoorInfo">
            <h5 class="col-md-1 pl-0 pr-0 pt-3 pb-2">Location : </h5>
            <span class="col-md-3 pt-3 pb-2 pl-0 pr-0 mb-2">
                <mat-select (selectionChange)="setLocation($event.value)">
                    <mat-option *ngFor="let res of locations$ | async" [value]="res">{{res.Name}}
                    </mat-option>
                </mat-select>
            </span>
            <span class="col-md"></span>
            <h5 class="col-md-1 pl-0 pr-0 pt-3 pb-2">Door : </h5>
            <span class="col-md-1 pt-3 pb-2 pl-0 pr-0 mb-2">
                <mat-select (selectionChange)="setDoor($event)">
                    <mat-option *ngFor="let res of doors" [value]="res">{{res}}
                    </mat-option>
                </mat-select>
            </span>
        </ng-container>
        <ng-container *ngIf="updAppointment$ | async"></ng-container>
        <div class="col-md-12">
            <div class="row">
                <button mat-flat-button color="primary" type="button" class="col-md-1" [matMenuTriggerFor]="menu" (click)="getLocationCheckIn()">View</button>
                <mat-menu #menu="matMenu" xPosition="before">
                    <div mat-menu-item *ngFor="let item of getCheckIns$ | async;let i=index" class="checkin-list">{{item.Name}}</div>
                </mat-menu>
                <div class="col-md-2" *ngIf="quantityPeople$ | async">{{qtyPeople}}</div>
            </div>
        </div>
        <div class="col-sm col-md col-lg-12">
            <div class="row mb-2">
                <div class="col-md ml-2 mr-2 mt-2 title-qeue">
                    Schedule App
                </div>
                <div class="col-md ml-2 mr-2 mt-2 title-qeue">
                    Walk-Ins
                    <button mat-mini-fab class="add_client" (click)="showAppointment()">
                        <mat-icon>add</mat-icon>
                    </button>
                </div>
                <div class="col-md ml-2 mr-2 mt-2 title-qeue">
                    Ready To Check-In
                </div>
            </div>
            <ng-container *ngIf="messages$ | async"></ng-container>
            <div class="row">
                <div cdkDropList
                    [cdkDropListConnectedTo]="[preCheckInList]"
                    [cdkDropListData]="schedule" class="col-md drop-qeue m-0">
                    <ng-container *ngIf="appointmentsSche$ | async"></ng-container>
                    <div
                        infiniteScroll
                        [infiniteScrollDistance]="2"
                        [infiniteScrollThrottle]="50"
                        (scrolled)="onScrollSche()"
                        [scrollWindow]="false" 
                        class="col-md ml-2 mr-2 plan">
                        <!-- <ng-container *ngFor="let item of buckets; let i=index"> -->
                        <mat-card class="mt-2 appCard" *ngIf="prevHour > 0">
                            <mat-card-content>
                                <div (click)="showPrevious = !showPrevious; getPreviousAppos(prevHour)">{{ (showPrevious ? '-' : '+') + ' Pending Citas from previous periods ' }}</div>
                            </mat-card-content>
                        </mat-card>
                        <ng-container *ngIf="appointmentsPrevious$ | async"></ng-container>
                        <ng-container class="" *ngIf="showPrevious">
                            <mat-card class="mt-2 appCard" *ngFor="let item of previous;let i=index" cdkDrag>
                                <div class="row pr-3 pl-3">
                                    <div class="card-user col-md-9 pl-0 pr-0">{{item.Name}}</div>
                                    <div class="card-time col-md pr-0 pl-0">{{item.DateAppo}}</div>
                                </div>
                                <div class="row pr-3 pl-3">
                                    <div class="card-phone col-md-9 pl-0 pr-0">+1 {{item.Phone | phone}}</div>
                                    <div class="card-disability col-md pr-0 pl-0">
                                        <mat-icon *ngIf="item.Disability == '1'" svgIcon="older"></mat-icon>
                                        <mat-icon *ngIf="item.Disability == '2'" svgIcon="pregnant"></mat-icon>
                                        <mat-icon *ngIf="item.Disability == '3'" svgIcon="handicap"></mat-icon>
                                    </div>
                                </div>
                                <ng-container *ngIf="showDetailsSche[i]">
                                    <div class="row pr-3 pl-3 mt-2 mb-2">
                                        <div class="card-contentprio col-md-6 pl-0">Companions: </div><div class="card-resultprio col-md">{{item.Companions}}</div>
                                    </div>
                                    <div class="row pr-3 pl-3 mt-2 mb-2">
                                        <div class="card-contentprio col-md-6 pl-0">Door: </div><div class="card-resultprio col-md">{{item.Door}}</div>
                                    </div>
                                    <div class="row pr-3 pl-3 mt-2 mb-2">
                                        <div class="card-contentprio col-md-6 pl-0">On Behalf: </div><div class="card-resultprio col-md">{{item.OnBehalf == '0' ? 'No' : 'Yes'}}</div>
                                    </div>
                                </ng-container>
                                <div class="row mb-0 mt-2">
                                    <div class="card-actions-left col-md-4">
                                        <button mat-icon-button color="secondary" (click)="showMessageSche[i] = !showMessageSche[i]; onShowMessage(item, i, 'schedule');">
                                            <mat-icon [matBadgeHidden]="item.Unread != 'H'" matBadgeSize="small" matBadge="*" matBadgePosition="after" matBadgeColor="warn" matBadgeOverlap="true" svgIcon="sms"></mat-icon>
                                        </button>
                                    </div>
                                    <div class="card-actions-center col-md-4">
                                        <button mat-icon-button color="secondary" (click)="onReadyCheckIn(item, 1)">
                                            <mat-icon svgIcon="readycheck"></mat-icon>
                                        </button>
                                    </div>
                                    <div class="card-actions-right col-md-4">
                                        <button mat-icon-button color="secondary" (click)="showDetailsSche[i] = !showDetailsSche[i]">
                                            <mat-icon svgIcon="expand"></mat-icon>
                                        </button>
                                    </div>
                                </div>
                                <div class="row pl-3 pr-3 mb-0 mt-3" *ngIf="showMessageSche[i]">
                                    <div class="col-md-11 pl-0 pr-0">
                                        <textarea class="card-text" #messageText matInput placeholder="Write a comment..."></textarea>
                                    </div>
                                    <div class="button-send col-md pr-0 pl-0">
                                        <button mat-icon-button type="button" (click)="onMessageApp(item.AppId, messageText.value ,i, 'schedule')">
                                            <mat-icon class="send_icon">send</mat-icon>
                                        </button>
                                    </div>
                                    <div class="card-chat pl-3 pr-3 mb-0 mt-3 col-md-12">
                                        <ng-container *ngFor="let item of getCommentsSche[i]">
                                            <div class="row row justify-content-start" *ngIf="item.U != undefined">
                                                <div class="card-chat-user col-md-9 pt-2 pb-2 mt-1 mb-1 mr-1 ml-1">
                                                    <div class="card-chat-time">{{item.T}}</div>
                                                    {{item.U}}
                                                </div>
                                            </div>
                                            <div class="row justify-content-end" *ngIf="item.H != undefined">
                                                <div class="card-chat-host col-md-9 pt-2 pb-2 mt-1 mb-1 mr-1 ml-1">
                                                    <div class="card-chat-time">{{item.T}}</div>
                                                    {{item.H}}
                                                </div>
                                            </div>
                                        </ng-container>
                                    </div>
                                </div>
                            </mat-card>
                        </ng-container>
                        <!-- </ng-container> -->
                        <mat-card class="mt-2 appCard" *ngFor="let item of schedule;let i=index" cdkDrag>
                            <div class="row pr-3 pl-3">
                                <div class="card-user col-md-9 pl-0 pr-0">{{item.Name}}</div>
                                <div class="card-time col-md pr-0 pl-0">{{item.DateAppo}}</div>
                            </div>
                            <div class="row pr-3 pl-3">
                                <div class="card-phone col-md-9 pl-0 pr-0">+1 {{item.Phone | phone}}</div>
                                <div class="card-disability col-md pr-0 pl-0">
                                    <mat-icon *ngIf="item.Disability == '1'" svgIcon="older"></mat-icon>
                                    <mat-icon *ngIf="item.Disability == '2'" svgIcon="pregnant"></mat-icon>
                                    <mat-icon *ngIf="item.Disability == '3'" svgIcon="handicap"></mat-icon>
                                </div>
                            </div>
                            <ng-container *ngIf="showDetailsSche[i]">
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">Companions: </div><div class="card-resultprio col-md">{{item.Companions}}</div>
                                </div>
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">Door: </div><div class="card-resultprio col-md">{{item.Door}}</div>
                                </div>
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">On Behalf: </div><div class="card-resultprio col-md">{{item.OnBehalf == '0' ? 'No' : 'Yes'}}</div>
                                </div>
                            </ng-container>
                            <div class="row mb-0 mt-2">
                                <div class="card-actions-left col-md-4">
                                    <button mat-icon-button color="secondary" (click)="showMessageSche[i] = !showMessageSche[i]; onShowMessage(item, i, 'schedule');">
                                        <mat-icon [matBadgeHidden]="item.Unread != 'H'" matBadgeSize="small" matBadge="*" matBadgePosition="after" matBadgeColor="warn" matBadgeOverlap="true" svgIcon="sms"></mat-icon>
                                    </button>
                                </div>
                                <div class="card-actions-center col-md-4">
                                    <button mat-icon-button color="secondary" (click)="onReadyCheckIn(item, 1)">
                                        <mat-icon svgIcon="readycheck"></mat-icon>
                                    </button>
                                </div>
                                <div class="card-actions-right col-md-4">
                                    <button mat-icon-button color="secondary" (click)="showDetailsSche[i] = !showDetailsSche[i]">
                                        <mat-icon svgIcon="expand"></mat-icon>
                                    </button>
                                </div>
                            </div>
                            <div class="row pl-3 pr-3 mb-0 mt-3" *ngIf="showMessageSche[i]">
                                <div class="col-md-11 pl-0 pr-0">
                                    <textarea class="card-text" #messageText matInput placeholder="Write a comment..."></textarea>
                                </div>
                                <div class="button-send col-md pr-0 pl-0">
                                    <button mat-icon-button type="button" (click)="onMessageApp(item.AppId, messageText.value ,i, 'schedule')">
                                        <mat-icon class="send_icon">send</mat-icon>
                                    </button>
                                </div>
                                <div class="card-chat pl-3 pr-3 mb-0 mt-3 col-md-12">
                                    <ng-container *ngFor="let item of getCommentsSche[i]">
                                        <div class="row row justify-content-start" *ngIf="item.U != undefined">
                                            <div class="card-chat-user col-md-9 pt-2 pb-2 mt-1 mb-1 mr-1 ml-1">
                                                <div class="card-chat-time">{{item.T}}</div>
                                                {{item.U}}
                                            </div>
                                        </div>
                                        <div class="row justify-content-end" *ngIf="item.H != undefined">
                                            <div class="card-chat-host col-md-9 pt-2 pb-2 mt-1 mb-1 mr-1 ml-1">
                                                <div class="card-chat-time">{{item.T}}</div>
                                                {{item.H}}
                                            </div>
                                        </div>
                                    </ng-container>
                                </div>
                            </div>
                        </mat-card>
                    </div>
                </div>
                <div cdkDropList 
                     [cdkDropListConnectedTo]="[preCheckInList]"
                     [cdkDropListData]="walkIns" class="col-md drop-qeue m-0">
                     <ng-container *ngIf="appointmentsWalk$ | async"></ng-container>
                     <div
                        infiniteScroll
                        [infiniteScrollDistance]="2"
                        [infiniteScrollThrottle]="50"
                        (scrolled)="onScrollWalk()"
                        [scrollWindow]="false" 
                        class="col-md ml-2 mr-2 walkin">
                        <mat-card *ngIf="showApp" class="card-Appointment mt-2">
                            <ng-container *ngIf="newAppointment$ | async"></ng-container>
                            <form [formGroup]="clientForm" (ngSubmit)="addAppointment()">
                                <div class="form-field pl-3 pr-3">
                                    <mat-form-field hintLabel="Phone number">
                                        <span matPrefix>+1 &nbsp;</span>
                                        <input matInput #Phone placeholder="(555) 555-1234" appPhoneMask maxlength="14" formControlName="Phone" [errorStateMatcher]="confirmValidParentMatcher">
                                        <mat-error *ngIf="f.Phone.invalid && f.Phone.touched">{{getErrorMessage('Phone')}}</mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="form-field pl-3 pr-3">
                                    <mat-form-field hintLabel="Name">
                                        <input matInput #Name placeholder="Name" maxlength="100" minlength="3" formControlName="Name"
                                            [errorStateMatcher]="confirmValidParentMatcher" required>
                                        <mat-error *ngIf="f.Name.invalid && f.Name.touched">{{getErrorMessage('Name')}}</mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="form-field pl-3 pr-3">
                                    <mat-form-field hintLabel="Email">
                                        <input matInput #Email placeholder="Email" maxlength="200" pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" formControlName="Email"
                                            [errorStateMatcher]="confirmValidParentMatcher">
                                        <mat-error *ngIf="f.Email.invalid && f.Email.touched">{{getErrorMessage('Email')}}</mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="form-field pl-3 pr-3">
                                    <mat-form-field hintLabel="Companions">
                                        <input matInput #Companions placeholder="Companions" maxlength="2" min="1" max="20" formControlName="Companions"
                                            [errorStateMatcher]="confirmValidParentMatcher">
                                        <mat-error *ngIf="f.Companions.invalid && f.Companions.touched">{{getErrorMessage('Companions')}}</mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="form-field pl-3 pr-3">
                                    <mat-form-field hintLabel="Date of birth">
                                        <mat-label>Date of birth</mat-label>
                                        <input matInput [matDatepicker]="dobClient" formControlName="DOB">
                                        <mat-datepicker-toggle matSuffix [for]="dobClient"></mat-datepicker-toggle>
                                        <mat-datepicker #dobClient></mat-datepicker>
                                    </mat-form-field>
                                </div>
                                <div class="form-field pl-3 pr-3">
                                    <label>Gender</label>
                                    <mat-radio-group aria-label="Select an option" formControlName="Gender" class="client_gender mt-0">
                                        <mat-radio-button matLine value="M">Male</mat-radio-button>
                                        <mat-radio-button matLine value="F">Female</mat-radio-button>
                                        <mat-radio-button matLine value="NA">Doesn't want to answer</mat-radio-button>
                                    </mat-radio-group>
                                </div>
                                <div class="form-field pl-3 pr-3">
                                    <label>Disability</label>
                                    <mat-radio-group aria-label="Select an option" formControlName="Disability" class="client_gender mt-0">
                                        <mat-radio-button matLine value="1">Elderly</mat-radio-button>
                                        <mat-radio-button matLine value="2">Pregnant</mat-radio-button>
                                        <mat-radio-button matLine value="3">Disable</mat-radio-button>
                                    </mat-radio-group>
                                </div>
                                <div class="form-field pl-3 pr-3">
                                    <label>Preference</label>
                                    <mat-radio-group aria-label="Select an option" formControlName="Preference" class="client_gender mt-0">
                                        <mat-radio-button matLine value="1">SMS</mat-radio-button>
                                        <mat-radio-button matLine value="2">Email</mat-radio-button>
                                        <mat-radio-button matLine value="3">Push Notification</mat-radio-button>
                                    </mat-radio-group>
                                </div>
                                <div>
                                    <button mat-flat-button color="primary" id="save" [disabled]="!clientForm.valid" class="ml-3 mr-3 mt-2">Save</button>
                                    <button mat-flat-button color="accent" id="cancel" type="button" (click)="onCancelAddAppointment()" class="mt-2">Cancel</button>
                                </div>
                                <!-- {{ clientForm.value | json }} -->
                            </form>
                        </mat-card>
                        <mat-card class="mt-2 appCard" *ngFor="let item of walkIns;let i=index" cdkDrag>
                            <div class="row pr-3 pl-3">
                                <div class="card-user col-md-9 pl-0 pr-0">{{item.Name}}</div>
                                <div class="card-time col-md pr-0 pl-0">{{item.DateAppo}}</div>
                            </div>
                            <div class="row pr-3 pl-3">
                                <div class="card-phone col-md-9 pl-0 pr-0">+1 {{item.Phone | phone}}</div>
                                <div class="card-disability col-md pr-0 pl-0">
                                    <mat-icon *ngIf="item.Disability == '1'" svgIcon="older"></mat-icon>
                                    <mat-icon *ngIf="item.Disability == '2'" svgIcon="pregnant"></mat-icon>
                                    <mat-icon *ngIf="item.Disability == '3'" svgIcon="handicap"></mat-icon>
                                </div>
                            </div>
                            <ng-container *ngIf="showDetailsWalk[i]">
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">Companions: </div><div class="card-resultprio col-md">{{item.Companions}}</div>
                                </div>
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">Door: </div><div class="card-resultprio col-md">{{item.Door}}</div>
                                </div>
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">On Behalf: </div><div class="card-resultprio col-md">{{item.OnBehalf == '0' ? 'No' : 'Yes'}}</div>
                                </div>
                            </ng-container>
                            <div class="row mb-0 mt-2">
                                <div class="card-actions-left col-md-4">
                                    <button mat-icon-button color="secondary" (click)="showMessageWalk[i] = !showMessageWalk[i]; onShowMessage(item, i, 'walkin');">
                                    <mat-icon [matBadgeHidden]="item.Unread != 'H'" matBadgeSize="small" matBadge="*" matBadgePosition="after" matBadgeColor="warn" matBadgeOverlap="true" svgIcon="sms"></mat-icon>
                                    </button>
                                </div>
                                <div class="card-actions-center col-md-4">
                                    <button mat-icon-button color="secondary" (click)="onReadyCheckIn(item, 2)">
                                        <mat-icon svgIcon="readycheck"></mat-icon>
                                    </button>
                                </div>
                                <div class="card-actions-right col-md-4">
                                    <button mat-icon-button color="secondary" (click)="showDetailsWalk[i] = !showDetailsWalk[i]">
                                        <mat-icon svgIcon="expand"></mat-icon>
                                    </button>
                                </div>
                            </div>
                            <div class="row pl-3 pr-3 mb-0 mt-3" *ngIf="showMessageWalk[i]">
                                <div class="col-md-11 pl-0 pr-0">
                                    <textarea class="card-text" #messageText matInput placeholder="Write a comment..."></textarea>
                                </div>
                                <div class="button-send col-md pr-0 pl-0">
                                    <button mat-icon-button type="button" (click)="onMessageApp(item.AppId, messageText.value ,i, 'walkin')">
                                        <mat-icon class="send_icon">send</mat-icon>
                                    </button>
                                </div>
                                <div class="card-chat pl-3 pr-3 mb-0 mt-3 col-md-12">
                                    <ng-container *ngFor="let item of getCommentsWalk[i]">
                                        <div class="row row justify-content-start" *ngIf="item.U != undefined">
                                            <div class="card-chat-user col-md-9 pt-2 pb-2 mt-1 mb-1 mr-1 ml-1">
                                                <div class="card-chat-time">{{item.T}}</div>
                                                {{item.U}}
                                            </div>
                                        </div>
                                        <div class="row justify-content-end" *ngIf="item.H != undefined">
                                            <div class="card-chat-host col-md-9 pt-2 pb-2 mt-1 mb-1 mr-1 ml-1">
                                                <div class="card-chat-time">{{item.T}}</div>
                                                {{item.H}}
                                            </div>
                                        </div>
                                    </ng-container>
                                </div>
                            </div>
                        </mat-card>
                    </div>
                </div>
                <div cdkDropList
                     #preCheckInList="cdkDropList"
                     (cdkDropListDropped)="drop($event)"
                     [cdkDropListData]="preCheckIn" class="col-md drop-qeue m-0">
                     <ng-container *ngIf="appointmentsPre$ | async"></ng-container>
                     <div
                        infiniteScroll
                        [infiniteScrollDistance]="2"
                        [infiniteScrollThrottle]="50"
                        (scrolled)="onScrollWalk()"
                        [scrollWindow]="false" 
                        class="col-md ml-2 mr-2 precheck">
                        <ng-container *ngIf="checkIn$ | async"></ng-container>
                        <mat-card class="mt-2 appCard" *ngFor="let item of preCheckIn;let i=index">
                            <div class="row pr-3 pl-3">
                                <div class="card-user col-md-9 pl-0 pr-0">{{item.Name}}</div>
                                <div class="col-md pr-0 pl-0">
                                    <mat-icon class="elapsed-clock" *ngIf="item.ElapsedTime != ''" svgIcon="clock"></mat-icon>
                                    <div class="elapsed-time">
                                        {{item.ElapsedTime}}
                                    </div>
                                    <div class="elapsed-tag">{{ (item.ElapsedTime > 1 ? 'mins' : 'min') }}</div>
                                </div>
                            </div>
                            <div class="row pr-3 pl-3">
                                <div class="card-phone col-md-9 pl-0 pr-0">+1 {{item.Phone | phone}}</div>
                                <div class="card-disability-pre col-md pr-0 pl-0">
                                    <mat-icon *ngIf="item.Disability == '1'" svgIcon="older"></mat-icon>
                                    <mat-icon *ngIf="item.Disability == '2'" svgIcon="pregnant"></mat-icon>
                                    <mat-icon *ngIf="item.Disability == '3'" svgIcon="handicap"></mat-icon>
                                </div>
                            </div>
                            <ng-container *ngIf="showDetailsPre[i]">
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">Companions: </div><div class="card-resultprio col-md">{{item.Companions}}</div>
                                </div>
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">Door: </div><div class="card-resultprio col-md">{{item.Door}}</div>
                                </div>
                                <div class="row pr-3 pl-3 mt-2 mb-2">
                                    <div class="card-contentprio col-md-6 pl-0">On Behalf: </div><div class="card-resultprio col-md">{{item.OnBehalf == '0' ? 'No' : 'Yes'}}</div>
                                </div>
                            </ng-container>
                            <div class="row mb-0 mt-2">
                                <div class="card-actions-center col-md-3">
                                    <button mat-icon-button color="secondary" (click)="showCancelOptions[i] = !showCancelOptions[i]">
                                        <mat-icon svgIcon="cancel"></mat-icon>
                                    </button>
                                </div>
                                <div class="card-actions-center col-md-3">
                                    <button mat-icon-button color="secondary" (click)="showMessagePre[i] = !showMessagePre[i]; onShowMessage(item, i, 'pre');">
                                    <mat-icon [matBadgeHidden]="item.Unread != 'H'" matBadgeSize="small" matBadge="*" matBadgePosition="after" matBadgeColor="warn" matBadgeOverlap="true" svgIcon="sms"></mat-icon>
                                    </button>
                                </div>
                                <div class="card-actions-center col-md-3">
                                    <button mat-icon-button color="secondary" (click)="onCheckInApp(item)">
                                        <mat-icon svgIcon="readycheck"></mat-icon>
                                    </button>
                                </div>
                                <div class="card-actions-center col-md-3">
                                    <button mat-icon-button color="secondary" (click)="showDetailsPre[i] = !showDetailsPre[i]">
                                        <mat-icon svgIcon="expand"></mat-icon>
                                    </button>
                                </div>
                            </div>
                            <div class="row pl-3 pr-3 mb-0 mt-3" *ngIf="showCancelOptions[i]">
                                <div class="col-md-12 pl-0 pr-0">
                                    <mat-form-field>
                                        <mat-label>Cancel reasons</mat-label>
                                        <mat-select [(value)]="selected[i]">
                                            <mat-option *ngFor="let reason of reasons" [value]="reason.ReasonId">
                                                {{reason.Description}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-12 pl-0 pr-0 mt-2 mb-2">
                                    <button mat-flat-button type="button" color="primary" (click)="onCancelApp(item, selected[i], i)" [disabled]="selected[i] == undefined">
                                        Cancel Appointment
                                    </button>
                                </div>
                            </div>
                            <div class="row pl-3 pr-3 mb-0 mt-3" *ngIf="showMessagePre[i]">
                                <div class="col-md-11 pl-0 pr-0">
                                    <textarea class="card-text" #messageText matInput placeholder="Write a comment..."></textarea>
                                </div>
                                <div class="button-send col-md pr-0 pl-0">
                                    <button mat-icon-button type="button" (click)="onMessageApp(item.AppId, messageText.value ,i, 'precheck')">
                                        <mat-icon class="send_icon">send</mat-icon>
                                    </button>
                                </div>
                                <div class="card-chat pl-3 pr-3 mb-0 mt-3 col-md-12">
                                    <ng-container *ngFor="let item of getCommentsPre[i]">
                                        <div class="row row justify-content-start" *ngIf="item.U != undefined">
                                            <div class="card-chat-user col-md-9 pt-2 pb-2 mt-1 mb-1 mr-1 ml-1">
                                                <div class="card-chat-time">{{item.T}}</div>
                                                {{item.U}}
                                            </div>
                                        </div>
                                        <div class="row justify-content-end" *ngIf="item.H != undefined">
                                            <div class="card-chat-host col-md-9 pt-2 pb-2 mt-1 mb-1 mr-1 ml-1">
                                                <div class="card-chat-time">{{item.T}}</div>
                                                {{item.H}}
                                            </div>
                                        </div>
                                    </ng-container>
                                </div>
                            </div>
                        </mat-card>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>